/**
This notice must be untouched at all times.
This is the COMPRESSED version of Draw2D
WebSite: http://www.draw2d.org
Copyright: 2006 Andreas Herz. All rights reserved.
Created: 5.11.2006 by Andreas Herz (Web: http://www.freegroup.de )
LICENSE: LGPL
**/

draw2d.Port=function(_9b3,_9b4){Corona=function(){};Corona.prototype=new draw2d.Circle();Corona.prototype.setAlpha=function(_9b5){draw2d.Circle.prototype.setAlpha.call(this,Math.min(0.3,_9b5));this.setDeleteable(false);this.setCanDrag(false);this.setResizeable(false);this.setSelectable(false);};if(_9b3===null||_9b3===undefined){this.currentUIRepresentation=new draw2d.Circle();}else{this.currentUIRepresentation=_9b3;}if(_9b4===null||_9b4===undefined){this.connectedUIRepresentation=new draw2d.Circle();this.connectedUIRepresentation.setColor(null);}else{this.connectedUIRepresentation=_9b4;}this.disconnectedUIRepresentation=this.currentUIRepresentation;this.hideIfConnected=false;this.uiRepresentationAdded=true;this.parentNode=null;this.originX=0;this.originY=0;this.coronaWidth=10;this.corona=null;draw2d.Rectangle.call(this);this.setDimension(8,8);this.setBackgroundColor(new draw2d.Color(100,180,100));this.setColor(new draw2d.Color(90,150,90));draw2d.Rectangle.prototype.setColor.call(this,null);this.dropable=new draw2d.DropTarget(this.html);this.dropable.node=this;this.dropable.addEventListener("dragenter",function(_9b6){_9b6.target.node.onDragEnter(_9b6.relatedTarget.node);});this.dropable.addEventListener("dragleave",function(_9b7){_9b7.target.node.onDragLeave(_9b7.relatedTarget.node);});this.dropable.addEventListener("drop",function(_9b8){_9b8.relatedTarget.node.onDrop(_9b8.target.node);});};draw2d.Port.prototype=new draw2d.Rectangle();draw2d.Port.prototype.type="draw2d.Port";draw2d.Port.ZOrderBaseIndex=5000;draw2d.Port.setZOrderBaseIndex=function(_9b9){draw2d.Port.ZOrderBaseIndex=_9b9;};draw2d.Port.prototype.setHideIfConnected=function(flag){this.hideIfConnected=flag;};draw2d.Port.prototype.dispose=function(){var size=this.moveListener.getSize();for(var i=0;i<size;i++){var _9bd=this.moveListener.get(i);this.parentNode.workflow.removeFigure(_9bd);_9bd.dispose();}draw2d.Rectangle.prototype.dispose.call(this);this.parentNode=null;this.dropable.node=null;this.dropable=null;this.disconnectedUIRepresentation.dispose();this.connectedUIRepresentation.dispose();};draw2d.Port.prototype.createHTMLElement=function(){var item=draw2d.Rectangle.prototype.createHTMLElement.call(this);item.style.zIndex=draw2d.Port.ZOrderBaseIndex;this.currentUIRepresentation.html.zIndex=draw2d.Port.ZOrderBaseIndex;item.appendChild(this.currentUIRepresentation.html);this.uiRepresentationAdded=true;return item;};draw2d.Port.prototype.setUiRepresentation=function(_9bf){if(_9bf===null){_9bf=new draw2d.Figure();}if(this.uiRepresentationAdded){this.html.removeChild(this.currentUIRepresentation.getHTMLElement());}this.html.appendChild(_9bf.getHTMLElement());_9bf.paint();this.currentUIRepresentation=_9bf;};draw2d.Port.prototype.onMouseEnter=function(){this.setLineWidth(2);};draw2d.Port.prototype.onMouseLeave=function(){this.setLineWidth(0);};draw2d.Port.prototype.setDimension=function(_9c0,_9c1){draw2d.Rectangle.prototype.setDimension.call(this,_9c0,_9c1);this.connectedUIRepresentation.setDimension(_9c0,_9c1);this.disconnectedUIRepresentation.setDimension(_9c0,_9c1);this.setPosition(this.x,this.y);};draw2d.Port.prototype.setBackgroundColor=function(_9c2){this.currentUIRepresentation.setBackgroundColor(_9c2);};draw2d.Port.prototype.getBackgroundColor=function(){return this.currentUIRepresentation.getBackgroundColor();};draw2d.Port.prototype.getConnections=function(){var _9c3=new draw2d.ArrayList();var size=this.moveListener.getSize();for(var i=0;i<size;i++){var _9c6=this.moveListener.get(i);if(_9c6 instanceof draw2d.Connection){_9c3.add(_9c6);}}return _9c3;};draw2d.Port.prototype.setColor=function(_9c7){this.currentUIRepresentation.setColor(_9c7);};draw2d.Port.prototype.getColor=function(){return this.currentUIRepresentation.getColor();};draw2d.Port.prototype.setLineWidth=function(_9c8){this.currentUIRepresentation.setLineWidth(_9c8);};draw2d.Port.prototype.getLineWidth=function(){return this.currentUIRepresentation.getLineWidth();};draw2d.Port.prototype.paint=function(){try{this.currentUIRepresentation.paint();}catch(e){pushErrorStack(e,"draw2d.Port.prototype.paint=function()");}};draw2d.Port.prototype.setPosition=function(xPos,yPos){this.originX=xPos;this.originY=yPos;draw2d.Rectangle.prototype.setPosition.call(this,xPos,yPos);if(this.html===null){return;}this.html.style.left=(this.x-this.getWidth()/2)+"px";this.html.style.top=(this.y-this.getHeight()/2)+"px";};draw2d.Port.prototype.setParent=function(_9cb){if(this.parentNode!==null){this.parentNode.detachMoveListener(this);}this.parentNode=_9cb;if(this.parentNode!==null){this.parentNode.attachMoveListener(this);}};draw2d.Port.prototype.attachMoveListener=function(_9cc){draw2d.Rectangle.prototype.attachMoveListener.call(this,_9cc);if(this.hideIfConnected==true){this.setUiRepresentation(this.connectedUIRepresentation);}};draw2d.Port.prototype.detachMoveListener=function(_9cd){draw2d.Rectangle.prototype.detachMoveListener.call(this,_9cd);if(this.getConnections().getSize()==0){this.setUiRepresentation(this.disconnectedUIRepresentation);}};draw2d.Port.prototype.getParent=function(){return this.parentNode;};draw2d.Port.prototype.onDrag=function(){draw2d.Rectangle.prototype.onDrag.call(this);this.parentNode.workflow.showConnectionLine(this.parentNode.x+this.x,this.parentNode.y+this.y,this.parentNode.x+this.originX,this.parentNode.y+this.originY);};draw2d.Port.prototype.getCoronaWidth=function(){return this.coronaWidth;};draw2d.Port.prototype.setCoronaWidth=function(_9ce){this.coronaWidth=_9ce;};draw2d.Port.prototype.setOrigin=function(x,y){this.originX=x;this.originY=y;};draw2d.Port.prototype.onDragend=function(){this.setAlpha(1);this.setPosition(this.originX,this.originY);this.parentNode.workflow.hideConnectionLine();document.body.focus();};draw2d.Port.prototype.onDragEnter=function(port){var _9d2=new draw2d.EditPolicy(draw2d.EditPolicy.CONNECT);_9d2.canvas=this.parentNode.workflow;_9d2.source=port;_9d2.target=this;var _9d3=this.createCommand(_9d2);if(_9d3===null){return;}this.parentNode.workflow.connectionLine.setColor(new draw2d.Color(0,150,0));this.parentNode.workflow.connectionLine.setLineWidth(3);this.showCorona(true);};draw2d.Port.prototype.onDragLeave=function(port){this.parentNode.workflow.connectionLine.setColor(new draw2d.Color(0,0,0));this.parentNode.workflow.connectionLine.setLineWidth(1);this.showCorona(false);};draw2d.Port.prototype.onDrop=function(port){var _9d6=new draw2d.EditPolicy(draw2d.EditPolicy.CONNECT);_9d6.canvas=this.parentNode.workflow;_9d6.source=port;_9d6.target=this;var _9d7=this.createCommand(_9d6);if(_9d7!==null){this.parentNode.workflow.getCommandStack().execute(_9d7);}};draw2d.Port.prototype.getAbsolutePosition=function(){return new draw2d.Point(this.getAbsoluteX(),this.getAbsoluteY());};draw2d.Port.prototype.getAbsoluteBounds=function(){return new draw2d.Dimension(this.getAbsoluteX(),this.getAbsoluteY(),this.getWidth(),this.getHeight());};draw2d.Port.prototype.getAbsoluteY=function(){return this.originY+this.parentNode.getY();};draw2d.Port.prototype.getAbsoluteX=function(){return this.originX+this.parentNode.getX();};draw2d.Port.prototype.onOtherFigureMoved=function(_9d8){this.fireMoveEvent();};draw2d.Port.prototype.getName=function(){return this.name;};draw2d.Port.prototype.setName=function(name){this.name=name;};draw2d.Port.prototype.isOver=function(iX,iY){var x=this.getAbsoluteX()-this.coronaWidth-this.getWidth()/2;var y=this.getAbsoluteY()-this.coronaWidth-this.getHeight()/2;var iX2=x+this.width+(this.coronaWidth*2);var iY2=y+this.height+(this.coronaWidth*2);return (iX>=x&&iX<=iX2&&iY>=y&&iY<=iY2);};draw2d.Port.prototype.showCorona=function(flag,_9e1){if(flag===true){this.corona=new Corona();this.corona.setAlpha(0.3);this.corona.setBackgroundColor(new draw2d.Color(0,125,125));this.corona.setColor(null);this.corona.setDimension(this.getWidth()+(this.getCoronaWidth()*2),this.getWidth()+(this.getCoronaWidth()*2));this.parentNode.getWorkflow().addFigure(this.corona,this.getAbsoluteX()-this.getCoronaWidth()-this.getWidth()/2,this.getAbsoluteY()-this.getCoronaWidth()-this.getHeight()/2);}else{if(flag===false&&this.corona!==null){this.parentNode.getWorkflow().removeFigure(this.corona);this.corona=null;}}};draw2d.Port.prototype.createCommand=function(_9e2){if(_9e2.getPolicy()===draw2d.EditPolicy.MOVE){if(!this.canDrag){return null;}return new draw2d.CommandMovePort(this);}if(_9e2.getPolicy()===draw2d.EditPolicy.CONNECT){if(_9e2.source.parentNode.id===_9e2.target.parentNode.id){return null;}else{return new draw2d.CommandConnect(_9e2.canvas,_9e2.source,_9e2.target);}}return null;};